{"version":3,"names":[],"mappings":"","sources":["upload-modal.js"],"sourcesContent":["!function n(a,t,r){function s(e,i){if(!t[e]){if(!a[e]){var o=\"function\"==typeof require&&require;if(!i&&o)return o(e,!0);if(l)return l(e,!0);throw(i=new Error(\"Cannot find module '\"+e+\"'\")).code=\"MODULE_NOT_FOUND\",i}o=t[e]={exports:{}},a[e][0].call(o.exports,function(i){return s(a[e][1][i]||i)},o,o.exports,n,a,t,r)}return t[e].exports}for(var l=\"function\"==typeof require&&require,i=0;i<r.length;i++)s(r[i]);return s}({1:[function(i,e,o){var u,w;jQuery,window.WPVimeoVideos.Hook_Type_Backend=1,window.WPVimeoVideos.Hook_Type_Frontend=2,window.WPVimeoVideos.UploaderModal=function(i,e){this.context=i,this.config=e||{}},window.WPVimeoVideos.UploaderModal.prototype.form=function(){var i,e=[],o=(!Vimeify_Modal_Config.enable_local_search||this.config.hasOwnProperty(\"local\")&&!this.config.local||e.push('<label><input type=\"radio\" class=\"vimeify-field-row vimeify-insert-type\" name=\"insert_type\" value=\"local\">'+Vimeify_Modal_Config.methods.local+\"</label>\"),!Vimeify_Modal_Config.enable_vimeo_search||this.config.hasOwnProperty(\"search\")&&!this.config.search||e.push('<label><input type=\"radio\" class=\"vimeify-field-row vimeify-insert-type\" name=\"insert_type\" value=\"search\">'+Vimeify_Modal_Config.methods.search+\"</label>\"),e=0===e.length?(i='<input type=\"hidden\" name=\"insert_type\" value=\"upload\">',\"display:block;\"):(i='<div class=\"vimeify-vimeo-form-row\">'+(e=['<label><input type=\"radio\" class=\"vimeify-field-row vimeify-insert-type\" name=\"insert_type\" value=\"upload\">'+Vimeify_Modal_Config.methods.upload+\"</label>\"].concat(e)).join(\"\\n\")+\"</div>\",\"display: none;\"),this.config.hasOwnProperty(\"source\")?this.config.source:\"Default\"),n=this.config.hasOwnProperty(\"hook_type\")?this.config.hook_type:window.WPVimeoVideos.Hook_Type_Backend,a=\"\";if(Vimeify_Modal_Config.upload_form_options.enable_view_privacy&&null!==Vimeify_Modal_Config.upload_form_options.privacy_view){var t,r=\"\";for(t in Vimeify_Modal_Config.upload_form_options.privacy_view){var s=Vimeify_Modal_Config.upload_form_options.privacy_view[t].name;r+=\"<option \"+(Vimeify_Modal_Config.upload_form_options.privacy_view[t].available?\"\":\"disabled\")+\" \"+(Vimeify_Modal_Config.upload_form_options.privacy_view[t].default?\"selected\":\"\")+' value=\"'+t+'\">'+s+\"</option>\"}a='<div class=\"vimeify-vimeo-form-row\">\\n<label for=\"vimeo_view_privacy\">'+Vimeify_Modal_Config.words.privacy_view+'</label><select name=\"vimeo_view_privacy\" class=\"vimeify-field-row vimeify-w-100\">'+r+\"</select>\\n</div>\\n\"}var l=(this.config.hasOwnProperty(\"title\")&&this.config.title?this.config:Vimeify_Modal_Config.phrases).title,d=\"\";return this.config.hasOwnProperty(\"meta\")&&this.config.meta&&(d=\"data-meta='\"+JSON.stringify(this.config.meta)+\"'\"),'<div id=\"'+this.context+'\" class=\"vimeify-vimeo-upload-form vimeify-vimeo-plain-form vimeify-text-left\">\\n\\n    <span class=\"vimeify-close-modal\">&#215;</span>\\n    <h4 class=\"vimeify-mt-0\">'+l+\"</h4>\\n\\n\"+i+'\\n    <div class=\"vimeify-insert-wrapper vimeify-insert-type-upload\" style=\"'+e+'\">\\n        <form id=\"vimeify-vimeo-upload-modal\" '+d+'>\\n            <input type=\"hidden\" name=\"vimeo_source\" value=\"'+o+'\">            <input type=\"hidden\" name=\"vimeo_hook_type\" value=\"'+n+'\">            <div class=\"vimeify-vimeo-form-row\">\\n                <label for=\"vimeo_title\">'+Vimeify_Modal_Config.words.title+'</label>                <input type=\"text\" name=\"vimeo_title\" class=\"vimeify-field-row\">\\n            </div>\\n            <div class=\"vimeify-vimeo-form-row\">\\n                <label for=\"vimeo_description\">'+Vimeify_Modal_Config.words.desc+'</label>                <textarea rows=\"5\" name=\"vimeo_description\" class=\"vimeify-field-row\"></textarea>\\n            </div>\\n'+a+'            <div class=\"vimeify-vimeo-form-row\">\\n                <label for=\"vimeo_video\">'+Vimeify_Modal_Config.words.file+'</label>                <input type=\"file\" name=\"vimeo_video\" class=\"vimeify-field-row\">\\n            </div>\\n            <div class=\"vimeify-vimeo-form-row\">\\n                <div class=\"vimeify-progress-bar\" style=\"display: none;\">\\n                    <div class=\"vimeify-progress-bar-inner\" style=\"width: 0;\"></div>\\n                    <div class=\"vimeify-progress-bar-value\">0%</div>\\n                </div>\\n            </div>\\n            <div class=\"vimeify-vimeo-form-row\">\\n                <div class=\"vimeify-loader\" style=\"display: none;\"></div>\\n                <button type=\"submit\" class=\"button submitUpload\" data-waiting=\"'+Vimeify_Modal_Config.words.uploading3d+'\" data-finished=\"Upload\">\\n                    Upload\\n                </button>\\n            </div>\\n        </form>\\n    </div>\\n\\n    <div class=\"vimeify-insert-wrapper vimeify-insert-type-local\" style=\"display:none;\">\\n        <div class=\"vimeify-vimeo-form-row\">\\n            <select class=\"vimeify-vimeo-existing\" style=\"display: none;\"></select>\\n            <button type=\"button\" name=\"insert_video\" class=\"button-primary insert_video\">'+Vimeify_Modal_Config.words.insert+'</button>\\n        </div>\\n        <div class=\"vimeify-vimeo-form-row vimeify-videos-404\" style=\"display: none;\">\\n            <p>'+Vimeify_Modal_Config.phrases.videos_not_found+'</p>\\n        </div>\\n    </div>\\n\\n    <div class=\"vimeify-insert-wrapper vimeify-insert-type-search\" style=\"display: none;\">\\n        <form id=\"vimeify-vimeo-search\" class=\"vimeify-vimeo-form-row\">\\n            <div class=\"vimeify-vimeo-form-row\">\\n                <input type=\"text\" name=\"video_title\" placeholder=\"'+Vimeify_Modal_Config.words.title+'\" class=\"vimeify-field-row\">\\n                <button type=\"submit\" class=\"button\" data-waiting=\"'+Vimeify_Modal_Config.words.searching3d+'\" data-finished=\"'+Vimeify_Modal_Config.words.upload+'\">'+Vimeify_Modal_Config.words.search+'</button>\\n            </div>\\n        </form>\\n        <div class=\"vimeify-vimeo-form-row vimeify-videos-found\" style=\"display: none;\">\\n            <select class=\"vimeify-vimeo-existing\"></select>\\n            <button type=\"button\" name=\"insert_video\" class=\"button-primary insert_video\">'+Vimeify_Modal_Config.words.insert+'</button>\\n        </div>\\n        <div class=\"vimeify-vimeo-form-row vimeify-videos-404\" style=\"display: none;\">\\n            <p>'+Vimeify_Modal_Config.phrases.search_not_found+\"</p>\\n        </div>\\n    </div>\\n\\n</div><style>.swal2-container {z-index: 999999 !important;}</style>\"},window.WPVimeoVideos.UploaderModal.prototype.open=function(){var i=this.form();swal.fire({showCloseButton:!1,showCancelButton:!1,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,html:i})},u=jQuery,window.VimeoUploaderModal={working:!1,uploader:null},w=[\"bytes\",\"KB\",\"MB\",\"GB\",\"TB\",\"PB\",\"EB\",\"ZB\",\"YB\"],u(document).on(\"change\",\".vimeify-insert-type\",function(i){u(this).closest(\".vimeify-vimeo-upload-form\").attr(\"id\");u(\".vimeify-insert-wrapper\").hide();var r=u(this),e=r.val(),o=u(\".vimeify-insert-type-\"+e);\"local\"===e&&u.ajax({url:Vimeify_Modal_Config.ajax_url+\"?action=vimeify_get_uploads\",data:{_wpnonce:Vimeify_Modal_Config.nonce},type:\"GET\",success:function(i){if(i.success){var e=i.data.uploads,o=u(\".vimeify-insert-type-local .vimeify-vimeo-existing\"),n=u(\".vimeify-insert-type-local .vimeify-videos-404\");if(0<e.length){var a,t=\"\";for(a in e)t+='<option value=\"'+e[a].vimeo_id+'\">'+e[a].title+\"</option>\";o.append(t),o.show()}else r.parent().hide(),n.show()}else swal.fire(Vimeify_Modal_Config.words.sorry,i.data.message,\"error\")},error:function(){swal.fire(Vimeify_Modal_Config.words.sorry,Vimeify_Modal_Config.phrases.http_error,\"error\")}}),o.show()}),u(document).on(\"submit\",\"#vimeify-vimeo-search\",function(){u(this).closest(\".vimeify-vimeo-upload-form\").attr(\"id\");var o,n,i=u(this).find(\"input[name=video_title]\").val(),a=\"\";return\"\"!==i?(o=u(this).closest(\".vimeify-insert-type-search\").find(\".vimeify-videos-found\"),n=u(this).closest(\".vimeify-insert-type-search\").find(\".vimeify-videos-404\"),new WPVimeoVideos.Profile(Vimeify_Modal_Config.access_token).search({page:1,per_page:100,query:i,sort:\"date\",direction:\"desc\",onSuccess:function(i){if(0<i.data.length){for(var e in i.data)a+='<option value=\"'+i.data[e].uri+'\">'+i.data[e].name+\"</option>\";n.hide(),o.find(\".vimeify-vimeo-existing\").html(a),o.show()}else o.hide(),n.show()},onError:function(i){swal.fire(Vimeify_Modal_Config.words.sorry,Vimeify_Modal_Config.phrases.invalid_search_phrase,\"error\")}})):swal.fire(Vimeify_Modal_Config.words.sorry,Vimeify_Modal_Config.phrases.invalid_search_phrase,\"error\"),!1}),u(document).on(\"click\",\".insert_video\",function(i){i.preventDefault();var i=u(this).closest(\".vimeify-vimeo-upload-form\").attr(\"id\"),e=u(this).closest(\".vimeify-vimeo-form-row\").find(\".vimeify-vimeo-existing\").val();e&&(e=e.replace(\"/videos/\",\"\"),u(window).trigger(\"wpvimeify.events.insert\",[{uri:e,context:i}]),swal.close())}),u(document).on(\"submit\",\"#vimeify-vimeo-upload-modal\",function(i){var n=u(this).closest(\".vimeify-vimeo-upload-form\").attr(\"id\"),a=u(this),t=a.find(\".vimeify-loader\"),r=a.find(\"button[type=submit]\"),s=a.find(\".vimeify-progress-bar\"),l=new FormData(this),d=l.get(\"vimeo_video\"),f=u(this).data(\"meta\");if(WPVimeoVideos.Uploader.validateVideo(d)){var m=l.get(\"vimeo_title\"),v=l.get(\"vimeo_description\"),y=l.get(\"vimeo_view_privacy\"),p=l.get(\"vimeo_source\")?l.get(\"vimeo_source\"):\"UploadModal\",l=l.get(\"vimeo_hook_type\")?l.get(\"vimeo_hook_type\"):1,y=y||Vimeify_Modal_Config.default_privacy,c=function(i,e){swal.fire(Vimeify_Modal_Config.words.sorry,e,\"error\")},_=function(i,e){i.is(\":hidden\")&&i.show(),i.find(\".vimeify-progress-bar-inner\").css({width:e+\"%\"}),i.find(\".vimeify-progress-bar-value\").text(e+\"%\")};let e={action:\"vimeify_store_upload\",source:p,hook_type:l,_wpnonce:Vimeify_Modal_Config.nonce},o=encodeURIComponent;p=Object.keys(e).map(i=>o(i)+\"=\"+o(e[i])).join(\"&\");window.VimeoUploaderModal.uploader=new WPVimeoVideos.Uploader(Vimeify_Modal_Config.access_token,d,{title:m,description:v,privacy:y,wp:{notify_endpoint:Vimeify_Modal_Config.ajax_url+\"?\"+p,notify_meta:f||null},beforeStart:function(){t.css({display:\"inline-block\"}),r.prop(\"disabled\",!0),window.VimeoUploaderModal.working=!0},onProgress:function(i,e){i=(i/e*100).toFixed(2);_(s,i)},onSuccess:function(i,e){var o=i.success?\"success\":\"error\",i=i.data.message;window.setTimeout(function(){a.get(0).reset(),t.css({display:\"none\"}),r.prop(\"disabled\",!1),_(s,0),s.hide()},1e3),swal.fire(Vimeify_Modal_Config.words.success,i,o);i=(i=e.uri).replace(\"/videos/\",\"\"),o={name:e.hasOwnProperty(\"name\")?e.name:\"\",description:e.hasOwnProperty(\"description\")?e.description:\"\",context:n,uri:i,full_uri:e.uri,size_formatted:(i=>{for(var e=0,o=parseInt(i,10)||0;1024<=o&&++e;)o/=1024;return o.toFixed(o<10&&0<e?1:0)+\" \"+w[e]})(e.upload.size),root:e};window.VimeoUploaderModal.working=!1,u(window).trigger(\"wpvimeify.events.upload\",[o])},onError:function(i){window.VimeoUploaderModal.working=!1,c(0,i)},onVideoCreateError:function(i){window.VimeoUploaderModal.working=!1,c(0,i)},onWPNotifyError:function(i){window.VimeoUploaderModal.working=!1,c(0,i)}}),window.VimeoUploaderModal.uploader.start()}else swal.fire(Vimeify_Modal_Config.words.sorry,Vimeify_Modal_Config.phrases.upload_invalid_file,\"error\");return!1}),u(document).on(\"click\",\".vimeify-close-modal\",function(i){i.preventDefault(),window.VimeoUploaderModal.working?confirm(Vimeify_Modal_Config.phrases.cancel_upload_confirm)&&(window.VimeoUploaderModal.uploader.abort(),window.VimeoUploaderModal.working=!1,swal.close()):swal.close()})},{}]},{},[1]);"],"file":"upload-modal.js"}